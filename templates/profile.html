{% load static %}
<html>
    <head>
        <link href="{% static 'img/favicon.ico' %}" rel="icon">

        <style>
            .profile-pic-wrapper {
                position: relative;
                width: 200px; /* Set the width and height to match your image size */
                height: 200px;
                justify-content: center;
                overflow: hidden;
                border-radius: 50%;
            }
            
            .profile-pic-container {
                position: relative;
                justify-content: center;
                width: 100%;
                height: 100%;
            }
            
            .profile-pic-container img {
                width: 100%;
                height: 100%;
                justify-content: center;
                object-fit: cover;
            }
            
            .file-overlay {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                background-color: rgba(0, 0, 0, 0.5);
                opacity: 0;
                transition: opacity 0.3s ease;
            }
            
            .profile-pic-wrapper:hover .file-overlay {
                opacity: 1;
            }
            
            .file {
                color: #fff;
                text-align: center;
                cursor: pointer;
                transition: background-color 0.3s ease;
            }
            
            .file:hover {
                background-color: rgba(0, 0, 0, 0.7);
            }
            .error-message{
              color: red;
          }
            
        </style>


        <script>
          // Function to validate phone number (10 digits)
          function validatePhoneNumber(input) {
            var phoneNumber = input.value.replace(/\D/g, ''); // Remove non-numeric characters
            var errorElement = input.nextElementSibling; // Get the next sibling element (assumes it's the error message element)
        
            if (phoneNumber.length === 10 && !/^0+$/.test(phoneNumber) && !/^0/.test(phoneNumber)) {
                input.classList.remove('is-invalid');
                if (errorElement) {
                    errorElement.textContent = ''; // Clear the error message
                }
            } else {
                input.classList.add('is-invalid');
                if (errorElement) {
                    errorElement.textContent = 'Phone number must be exactly 10 digits, not full zeros, and should not start with zero.'; // Set the error message
                }
            }
        }
        
          // Function to validate country, state, and city (alphabets only)
          function validateAlphabets(input) {
            var inputValue = input.value.trim(); // Remove leading and trailing spaces
            var pattern = /^[a-zA-Z\s]+$/;
            var errorElement = input.nextElementSibling; // Get the next sibling element (assumes it's the error message element)
        
            if (inputValue.length >= 2 && pattern.test(inputValue)) {
                input.classList.remove('is-invalid');
                if (errorElement) {
                    errorElement.textContent = ''; // Clear the error message
                }
            } else {
                input.classList.add('is-invalid');
                if (errorElement) {
                    errorElement.textContent = 'Please enter at least 2 alphabetic characters.'; // Set the error message
                }
            }
        }
        
          // Function to validate pincode (6 digits)
          function validatePincode(input) {
            var pincode = input.value.trim(); // Remove leading and trailing spaces
            var pattern = /^\d{6}$/;
            var errorElement = input.nextElementSibling; // Get the next sibling element (assumes it's the error message element)
        
            if (pattern.test(pincode) && !/^0+$/.test(pincode)) {
                input.classList.remove('is-invalid');
                if (errorElement) {
                    errorElement.textContent = ''; // Clear the error message
                }
            } else {
                input.classList.add('is-invalid');
                if (errorElement) {
                    if (/^0+$/.test(pincode)) {
                        errorElement.textContent = 'Enter a valid 6 digit pincode.';
                    } else {
                        errorElement.textContent = 'Enter a valid 6 digit pincode.';
                    }
                }
            }
        }
        function validatePassword(input) {
          var password = input.value;
          var minLength = 5;
          var uppercaseRegex = /[A-Z]/;
          var lowercaseRegex = /[a-z]/;
          var digitRegex = /[0-9]/;
          var specialCharRegex = /[!@#$%^&*()_+{}\[\]:;<>,.?~\\-]/;
          var errorElement = input.nextElementSibling; // Get the next sibling element (assumes it's the error message element)
      
          if (
              password.length >= minLength &&
              uppercaseRegex.test(password) &&
              lowercaseRegex.test(password) &&
              digitRegex.test(password) &&
              specialCharRegex.test(password)
          ) {
              input.classList.remove('is-invalid');
              if (errorElement) {
                  errorElement.textContent = ''; // Clear the error message
              }
          } else {
              input.classList.add('is-invalid');
              if (errorElement) {
                  errorElement.textContent = 'Password must contain at least 5 characters, one uppercase letter, one lowercase letter, one digit, and one special character.'; // Set the error message
              }
          }
      }

      function validatePass() {
        var newPassword = document.getElementById("new_password").value;
        var confirmPassword = document.getElementById("confirm_password").value;
        var passwordError = document.getElementById("password-error");
    
        if (newPassword !== confirmPassword) {
            passwordError.innerHTML = "Passwords do not match";
            return false; // Prevent form submission
        } else {
            passwordError.innerHTML = ""; // Clear error message
            return true; // Allow form submission
        }
    }
      
      
        </script>
        

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@500;600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet"> 

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="careergo/static/css/animate.min.css">

    <!-- Libraries Stylesheet -->
    <link href="{% static 'lib/owlcarousel/assets/owl.carousel.min.css' %}" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="{% static 'css/style.css' %}" rel="stylesheet">

    </head>
    <body>
        <div class="container-xl px-4 mt-4">
            <!-- Account page navigation-->
            <nav class="navbar navbar-expand-lg bg-white navbar-light py-3 py-lg-0 px-lg-5">
                <a href="{% url 'index' %}" class="navbar-brand ml-lg-3">
                    <h1 class="m-0 text-uppercase text-primary"><i class="fa fa-book-reader mr-3"></i>CAREERGO</h1>
                </a>
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse justify-content-between px-lg-3" id="navbarCollapse">
                    <div class="navbar-nav mx-auto py-0">

                      {% if user.role == user.COURSE_PROVIDER %}
                        <a href="{% url 'providerpage' %}" class="nav-item nav-link active">Home</a>
                        <a href="{% url 'profile' %}" class="nav-item nav-link active">Profile</a>
                      {% else %}
                      <a href="{% url 'index' %}" class="nav-item nav-link active">Home</a>
                        <a href="{% url 'profile' %}" class="nav-item nav-link active">Profile</a>
                      {% endif %}
            </nav>
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <section class="gray pt-5 pb-5">
                    <div class="container-fluid">
            
                        <div class="row justify-content-center">
            
                            <div class="col-lg-9 col-md-8">
                                <div class="dashboard-body">
            
                                    <div class="dashboard-wraper">
                                        <div class="row">
            
                                            <div class="col-lg-12 col-md-12">
                                                <div class="submit-page px-0">
                                                    <div class="form-group col-md-12 text-center">
                                                        <center>
                                                      <label class="mt-2 mb-1">Profile Photo</label>
                                                      <div class="profile-photo">
                                                        <div class="profile-pic-wrapper mt-3">
                                                          <div class="profile-pic-container">
                                                            {% if user_profile.profile %}
                                                            <img class="rounded-circle" src="{{ user_profile.profile.url }}" alt="Profile Picture" style="width: 200px; height: 200px;" />
                                                          {% else %}
                                                            <div class="rounded-circle no-file-message">
                                                              <img class="rounded-circle" src="{% static '/img/avatar.jpeg' %}" alt="Profile Picture" style="width: 200px; height: 200px;" />
                                                            </div>
                                                          {% endif %}
                                                            <div class="file-overlay">
                                                              <div class="file btn btn-sm btn-primary mt-2" style="background-color: transparent; border: none;">
                                                                <input type="file" name="profile_pic">
                                                              </div>
                                                            </div>
                                                          </div>
                                                        </div>
                                                      </div>
                                                    </center>
                                                    </div>
                                                  </div>
                                                  
                                    
                                                    <!-- Basic Information -->
                                                    <div class="frm_submit_block  mb-5">
                                                        <h3>{{ user.username }}</h3>
                                                        <div class="frm_submit_wrap">
                                                            <div class="row">
            
                                      <div class="form-group col-md-6 pd-20">
                                        <label class="mt-2 mb-1">UserName</label>
                                        <input type="text" name="username" class="form-control" value="{{ user.username }}" disabled>
                                    </div>
                                      <div class="form-group col-md-6 pd-20">
                                        <label class="mt-2 mb-1">Email</label>
                                        <input type="text" name="email" class="form-control" value="{{ user.email }}" disabled>
                                    </div>
                                    <div class="form-group col-md-6 pd-20">
                                      <label class="mt-2 mb-1">First Name</label>
                                      <input type="text" name="first_name" class="form-control" value="{{ user.first_name }}" readonly>
                                    </div>
                                    <div class="form-group col-md-6 pd-20">
                                      <label class="mt-2 mb-1">Last Name</label>
                                      <input type="text" name="last_name" class="form-control" value="{{ user.last_name }}" readonly>
                                    </div>
                                    <div class="form-group col-md-6 pd-20">
                                      <label class="mt-2 mb-1">Phone Number</label>
                                      <input type="text" id="phone_no" name="phone_no" class="form-control" value="{{ user.phone_no }}" onkeyup="validatePhoneNumber(this)">
                                      <div class="error-message"></div>
                                    </div>


                                    <div class="form-group col-md-6 pd-20">
                                      <label class="mt-2 mb-1">Country</label>
                                      <select name="country" id="countryDropdown" class="form-control">
                                          <option value="">Select a country</option>
                                          <option value="USA" {% if user_profile.country == 'USA' %}selected{% endif %}>United States</option>
                                          <option value="Canada" {% if user_profile.country == 'Canada' %}selected{% endif %}>Canada</option>
                                          <option id="India" value="India" {% if user_profile.country == 'India' %}selected{% endif %}>India</option>
                                          <option value="Australia" {% if user_profile.country == 'Australia' %}selected{% endif %}>Australia</option>
                                          <option value="UK" {% if user_profile.country == 'UK' %}selected{% endif %}>UK</option>
                                          <option value="Germany" {% if user_profile.country == 'Germany' %}selected{% endif %}>Germany</option>
                                          <option value="France" {% if user_profile.country == 'France' %}selected{% endif %}>France</option>
                                          <option value="Brazil" {% if user_profile.country == 'Brazil' %}selected{% endif %}>Brazil</option>
                                          <option value="Japan" {% if user_profile.country == 'Japan' %}selected{% endif %}>Japan</option>
                                          <option value="China" {% if user_profile.country == 'China' %}selected{% endif %}>China</option>
                                          <option value="Russia" {% if user_profile.country == 'Russia' %}selected{% endif %}>Russia</option>
                                          <option value="Mexico" {% if user_profile.country == 'Mexico' %}selected{% endif %}>Mexico</option>
                                          
                                          <!-- Add more countries as needed -->
                                      </select>
                                      <input type="hidden" name="selected_country" id="selectedCountry">
                                  </div>
                                  <div class="form-group col-md-6 pd-20">
                                      <!-- Update the name attribute to "selected_state" -->
                                      <input type="hidden" name="selected_state" value="{{ user_profile.state }}" id="selectedState">
                                      <label class="mt-2 mb-1">State</label>
                                      <select name="state" id="stateDropdown" class="form-control">
                                          <option value="">Select a state</option>
                                          <!-- Options for states should be dynamically populated via JavaScript -->
                                      </select>
                                  </div>
                                  



                                  
                                    <div class="form-group col-md-6 pd-20">
                                      <label class="mt-2 mb-1">City</label>
                                      <input type="text" name="city" id="twon" class="form-control" value="{{ user_profile.city }}" onkeyup="validateAlphabets(this)">
                                      <div class="error-message"></div>
                                    </div>
                                    <div class="form-group col-md-6 pd-20">
                                      <label class="mt-2 mb-1">pincode</label>
                                      <input type="text" id="pincode" name="pin_code" class="form-control" value="{{ user_profile.pin_code }}" onkeyup="validatePincode(this)">
                                      <div class="error-message"></div>
                                    </div>

                                    {% comment %} <div class="form-group col-md-6 pd-20">
                                      <label class="mt-2 mb-1">Update Password</label>
                                      <input type="text" name="password" class="form-control" value="{{ user.password }}" onkeyup="validatePassword(this)">
                                      <div class="error-message"></div>
                                    </div> {% endcomment %}

                                    <div class="form-group col-md-6 pd-20">
                                      <label for="new_password" class="mt-2 mb-1">New Password:</label>
                                      <input type="password" name="new_password" id="new_password" class="form-control" onkeyup="validatePassword(this)">
                                      <div class="error-message"></div>
                                  </div>
                                  
                                  <div class="form-group col-md-6 pd-20">
                                      <label for="confirm_password" class="mt-2 mb-1">Confirm Password:</label>
                                      <input type="password" name="confirm_password" id="confirm_password" class="form-control" onkeyup="validatePass(this)">
                                      <div class="error-message" id="password-error"></div>
                                  </div>
                                  
                                                                <!-- More form fields... -->
            
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <div class="form-group col-lg-12 col-md-12 text-center">
                                                        <button class="btn btn-success" id="submit" type="submit">Submit</button>
                                                    </div>
            
                                                </div>
                                            </div>
            
                                        </div>
            
                                    </div>
                                    <!-- row -->
            
                                </div>
                            </div>
            
                        </div>
                    </div>
                </section>
            </form>
  
</body>
<script>
    const countryToStates = {
        USA: ["New York", "California", "Texas", "Florida", "Illinois", "Pennsylvania", "Ohio", "Michigan", "Georgia", "North Carolina"],
        Canada: ["Ontario", "Quebec", "British Columbia", "Alberta", "Manitoba", "Saskatchewan", "New Brunswick", "Nova Scotia", "Prince Edward Island", "Newfoundland and Labrador"],
        India: ["Maharashtra", "Tamil Nadu", "Uttar Pradesh", "Karnataka", "Gujarat", "Kerala", "Andhra Pradesh", "Rajasthan", "Madhya Pradesh", "Telangana"],
        Australia: ["New South Wales", "Victoria", "Queensland", "Western Australia", "South Australia", "Tasmania", "Northern Territory", "Australian Capital Territory", "Jervis Bay Territory", "Christmas Island"],
        UK: ["England", "Scotland", "Wales", "Northern Ireland", "London", "Yorkshire", "Merseyside", "Highlands", "Belfast", "Cardiff"],
        Germany: ["Berlin", "Bavaria", "North Rhine-Westphalia", "Baden-Württemberg", "Lower Saxony", "Hesse", "Rhineland-Palatinate", "Saxony", "Brandenburg", "Saxony-Anhalt"],
        France: ["Île-de-France", "Provence-Alpes-Côte d'Azur", "Auvergne-Rhône-Alpes", "Occitanie", "Nouvelle-Aquitaine", "Hauts-de-France", "Grand Est", "Brittany", "Normandy", "Pays de la Loire"],
        Brazil: ["São Paulo", "Rio de Janeiro", "Minas Gerais", "Bahia", "Rio Grande do Sul", "Paraná", "Ceará", "Pernambuco", "Santa Catarina", "Goiás"],
        Japan: ["Tokyo", "Osaka", "Kanagawa", "Aichi", "Hokkaido", "Chiba", "Saitama", "Hyogo", "Fukuoka", "Shizuoka"],
        China: ["Beijing", "Shanghai", "Guangdong", "Jiangsu", "Zhejiang", "Shandong", "Henan", "Sichuan", "Hubei", "Hebei"],
        Russia: ["Moscow", "Saint Petersburg", "Novosibirsk", "Yekaterinburg", "Nizhny Novgorod", "Kazan", "Chelyabinsk", "Omsk", "Samara", "Rostov-on-Don"],
        Mexico: ["Mexico City", "Jalisco", "Nuevo León", "Guanajuato", "Puebla", "Veracruz", "Baja California", "Sinaloa", "Sonora", "Michoacán"],
       
        // Add more countries and their states as needed
    };
    

    // Function to update the state dropdown options based on the selected country
    function updateStateDropdown() {
        const countryDropdown = document.getElementById("countryDropdown");
        const stateDropdown = document.getElementById("stateDropdown");
        const selectedCountry = countryDropdown.value;

        // Clear existing options in the "State" dropdown
        stateDropdown.innerHTML = '<option value="">Select a state</option>';

        // Populate the "State" dropdown based on the selected country
        if (selectedCountry && countryToStates[selectedCountry]) {
            const states = countryToStates[selectedCountry];
            for (const state of states) {
                const option = document.createElement("option");
                option.value = state;
                option.textContent = state;
                stateDropdown.appendChild(option);
            }
        }

        // Set the value of the hidden input field for selected country
        document.getElementById("selectedCountry").value = selectedCountry;
    }

    // Add an event listener to the "State" dropdown to update selectedState
    const stateDropdown = document.getElementById("stateDropdown");
    const selectedStateInput = document.getElementById("selectedState");

    stateDropdown.addEventListener("change", function () {
        const selectedState = stateDropdown.value;
        selectedStateInput.value = selectedState; // Update the hidden input field
        console.log("Selected State:", selectedState);
    });

    // Ensure that the updateStateDropdown function is called when the country changes.
    const countryDropdown = document.getElementById("countryDropdown");
    if (countryDropdown) {
        countryDropdown.addEventListener("change", updateStateDropdown);
    }

    // Initial population of the state dropdown
    updateStateDropdown();
</script>

  </html>